{
  "scenario_id": "water_treatment",
  "description": "Representative smart wastewater treatment plant with cascading tanks, sensors, PLCs connected to HMI and control center.",
  "nodes": [
    {
      "device_id": "influent_plc",
      "name": "Influent Pump PLC",
      "device_type": "PLC",
      "ip_address": "10.1.1.10",
      "neighbors": ["influent_hmi", "clarifier_plc"],
      "connections": [
        {
          "target": "influent_hmi",
          "segment": "Level 1 pump control loop",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Supervisory control of influent pump rates."
        },
        {
          "target": "clarifier_plc",
          "segment": "Level 1 interlock ring",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Clarifier pump coordination."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2019-10934",
          "cvss_base": 8.1,
          "epss": 0.29,
          "mapped_techniques": ["T0810", "T0820"]
        }
      ]
    },
    {
      "device_id": "influent_hmi",
      "name": "Influent HMI",
      "device_type": "HMI",
      "ip_address": "10.1.1.20",
      "neighbors": ["influent_plc", "control_room_ws"],
      "connections": [
        {
          "target": "influent_plc",
          "segment": "Level 1 pump control loop",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Operator visibility and manual overrides."
        },
        {
          "target": "control_room_ws",
          "segment": "Level 2 operations LAN",
          "protocols": ["SMB", "RDP"],
          "direction": "bidirectional",
          "notes": "Recipe deployment and alarm acknowledgement."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2022-31813",
          "cvss_base": 8.6,
          "epss": 0.51,
          "mapped_techniques": ["T0829", "T0889"]
        }
      ]
    },
    {
      "device_id": "clarifier_plc",
      "name": "Clarifier PLC",
      "device_type": "PLC",
      "ip_address": "10.1.2.10",
      "neighbors": ["influent_plc", "control_room_ws", "filter_plc"],
      "connections": [
        {
          "target": "influent_plc",
          "segment": "Level 1 interlock ring",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Coordinated sedimentation control."
        },
        {
          "target": "control_room_ws",
          "segment": "Level 2 operations LAN",
          "protocols": ["OPC UA"],
          "direction": "outbound",
          "notes": "Process data streaming to control room."
        },
        {
          "target": "filter_plc",
          "segment": "Level 1 interlock ring",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Clarifier-filter step synchronization."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2021-33012",
          "cvss_base": 7.8,
          "epss": 0.42,
          "mapped_techniques": ["T0830"]
        }
      ]
    },
    {
      "device_id": "filter_plc",
      "name": "Filtration PLC",
      "device_type": "PLC",
      "ip_address": "10.1.3.10",
      "neighbors": ["clarifier_plc", "filter_hmi"],
      "connections": [
        {
          "target": "clarifier_plc",
          "segment": "Level 1 interlock ring",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Filter inflow coordination."
        },
        {
          "target": "filter_hmi",
          "segment": "Level 1 filter control loop",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Local filter monitoring."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2020-6997",
          "cvss_base": 7.5,
          "epss": 0.18,
          "mapped_techniques": ["T0826"]
        }
      ]
    },
    {
      "device_id": "filter_hmi",
      "name": "Filtration HMI",
      "device_type": "HMI",
      "ip_address": "10.1.3.20",
      "neighbors": ["filter_plc", "control_room_ws"],
      "connections": [
        {
          "target": "filter_plc",
          "segment": "Level 1 filter control loop",
          "protocols": ["Modbus/TCP"],
          "direction": "bidirectional",
          "notes": "Media backwash control and local alarm display."
        },
        {
          "target": "control_room_ws",
          "segment": "Level 2 operations LAN",
          "protocols": ["RDP", "SMB"],
          "direction": "bidirectional",
          "notes": "Patch deployment and centralized supervision."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2021-42237",
          "cvss_base": 9.0,
          "epss": 0.77,
          "mapped_techniques": ["T0813", "T0889"]
        }
      ]
    },
    {
      "device_id": "control_room_ws",
      "name": "Control Room Workstation",
      "device_type": "EngineeringWorkstation",
      "ip_address": "10.1.4.10",
      "neighbors": [
        "influent_hmi",
        "clarifier_plc",
        "filter_hmi",
        "scada_server"
      ],
      "connections": [
        {
          "target": "influent_hmi",
          "segment": "Level 2 operations LAN",
          "protocols": ["SMB", "RDP"],
          "direction": "bidirectional",
          "notes": "Operator oversight and remote access."
        },
        {
          "target": "clarifier_plc",
          "segment": "Level 2 operations LAN",
          "protocols": ["OPC UA"],
          "direction": "bidirectional",
          "notes": "Historian data collection."
        },
        {
          "target": "filter_hmi",
          "segment": "Level 2 operations LAN",
          "protocols": ["RDP"],
          "direction": "bidirectional",
          "notes": "Maintenance interface."
        },
        {
          "target": "scada_server",
          "segment": "Level 2 to Level 3 conduit",
          "protocols": ["OPC UA", "HTTPS"],
          "direction": "bidirectional",
          "notes": "SCADA supervisory functions."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2022-38023",
          "cvss_base": 7.8,
          "epss": 0.47,
          "mapped_techniques": ["T0849", "T0865"]
        }
      ]
    },
    {
      "device_id": "scada_server",
      "name": "SCADA Server",
      "device_type": "SCADA",
      "ip_address": "10.1.5.10",
      "neighbors": ["control_room_ws", "corporate_gateway"],
      "connections": [
        {
          "target": "control_room_ws",
          "segment": "Level 3 supervisory network",
          "protocols": ["OPC UA", "HTTPS"],
          "direction": "bidirectional",
          "notes": "Centralized supervision and historian services."
        },
        {
          "target": "corporate_gateway",
          "segment": "Level 3 to Level 4 conduit",
          "protocols": ["HTTPS", "SQL"],
          "direction": "outbound",
          "notes": "Reporting and dashboard distribution."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2021-44228",
          "cvss_base": 10.0,
          "epss": 0.99,
          "mapped_techniques": ["T0859", "T0843", "T1595"]
        }
      ]
    },
    {
      "device_id": "corporate_gateway",
      "name": "Corporate Gateway",
      "device_type": "Gateway",
      "ip_address": "10.1.6.1",
      "neighbors": ["scada_server", "corporate_ops"],
      "connections": [
        {
          "target": "scada_server",
          "segment": "Level 3 to Level 4 conduit",
          "protocols": ["HTTPS"],
          "direction": "inbound",
          "notes": "Limited northbound exposure for reporting."
        },
        {
          "target": "corporate_ops",
          "segment": "Level 4 enterprise core",
          "protocols": ["HTTPS", "SMB"],
          "direction": "bidirectional",
          "notes": "Enterprise analytics and patch staging."
        }
      ],
      "vulnerabilities": []
    },
    {
      "device_id": "corporate_ops",
      "name": "Corporate Operations Servers",
      "device_type": "ServerCluster",
      "ip_address": "10.1.6.20",
      "neighbors": ["corporate_gateway"],
      "connections": [
        {
          "target": "corporate_gateway",
          "segment": "Level 4 enterprise core",
          "protocols": ["HTTPS", "SMB"],
          "direction": "bidirectional",
          "notes": "Business analytics and remote support."
        }
      ],
      "vulnerabilities": [
        {
          "cve_id": "CVE-2023-23397",
          "cvss_base": 9.8,
          "epss": 0.81,
          "mapped_techniques": ["T1566", "T1204", "T1078"]
        }
      ]
    }
  ]
}

